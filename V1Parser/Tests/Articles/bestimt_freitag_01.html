<html><!-- #BeginTemplate "/Templates/features - article.dwt" -->
<head>
<!-- #BeginEditable "doctitle" --> 
<title>Gamasutra - Features - &quot;Real-time Shadow Casting Using Shadow Volumes&quot; [11.15.99]</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<SCRIPT language=javascript1.1>
<!--
function OnTopWindow(winwidth,winheight,file_name) {
	TopWindow = window.open(file_name,"Media","toolbar=no,width=" +
winwidth + ",height=" + winheight + ",directories=no,status=yes,scrollbars=no,resize=no,menubar=no")
}
//  -->
</SCRIPT>
<script language="JavaScript">
<!--
function MM_preloadImages() { //v2.0
  if (document.images) {
    var imgFiles = MM_preloadImages.arguments;
    if (document.preloadArray==null) document.preloadArray = new Array();
    var i = document.preloadArray.length;
    with (document) for (var j=0; j<imgFiles.length; j++) if (imgFiles[j].charAt(0)!="#"){
      preloadArray[i] = new Image;
      preloadArray[i++].src = imgFiles[j];
  } }
}

function MM_swapImgRestore() { //v2.0
  if (document.MM_swapImgData != null)
    for (var i=0; i<(document.MM_swapImgData.length-1); i+=2)
      document.MM_swapImgData[i].src = document.MM_swapImgData[i+1];
}

function MM_swapImage() { //v2.0
  var i,j=0,objStr,obj,swapArray=new Array,oldArray=document.MM_swapImgData;
  for (i=0; i < (MM_swapImage.arguments.length-2); i+=3) {
    objStr = MM_swapImage.arguments[(navigator.appName == 'Netscape')?i:i+1];
    if ((objStr.indexOf('document.layers[')==0 && document.layers==null) ||
        (objStr.indexOf('document.all[')   ==0 && document.all   ==null))
      objStr = 'document'+objStr.substring(objStr.lastIndexOf('.'),objStr.length);
    obj = eval(objStr);
    if (obj != null) {
      swapArray[j++] = obj;
      swapArray[j++] = (oldArray==null || oldArray[j-1]!=obj)?obj.src:oldArray[j];
      obj.src = MM_swapImage.arguments[i+2];
  } }
  document.MM_swapImgData = swapArray; //used for restore
}
//-->
</script>
<body bgcolor="#FFFFCC" link="#880000" vlink="#000000" ONLOAD="MM_preloadImages('../../db_area/images/layout/99join_on.gif','#920582065544');MM_preloadImages('../../db_area/images/layout/99help_on.gif','#920582346659');MM_preloadImages('../../db_area/images/layout/99contact_on.gif','#920582404742');MM_preloadImages('../../db_area/images/layout/99shop_on.gif','#920583266882');MM_preloadImages('../../db_area/images/layout/99search_on.gif','#920592177354');MM_preloadImages('../../db_area/images/layout/99news_on.gif','#920515198692');MM_preloadImages('../../db_area/images/layout/99features_on.gif','#920516131613');MM_preloadImages('../../db_area/images/layout/99connect_on.gif','#920516339983');MM_preloadImages('../../db_area/images/layout/99job_on.gif','#920516860121');MM_preloadImages('../../db_area/images/layout/99direct_on.gif','#920516953545')" ALINK="#880000">
<!-- #BeginLibraryItem "/Library/99_ads.lbi" --><table width="599" border="0" cellspacing="0" cellpadding="0" height="68">
  <tr> 
    <td width="468" height="60" align="left"><!-- begin main ad tag --><A HREF="http://sally.songline.com:80/@KLJ0ZS1fNTjJ6TqoYEFvwWzJwWLv9m2Cr0dsk4dtT3ZhaicrZVhJblRnpya3bGLZ42hZ44DAa4LXMNdiRyBSO0dsk4dtT3ZhaicQw49hrhZjbn2hP49jb4-fw4zs?"><IMG SRC="http://sally.songline.com:80/@GbT39T1LOIb7_paeY-Yvk4Voam2yaWhvbiDSbGhlk0DWZXIupW9Zk450R0s3dWzt42hZ42hvQX-t2yByw8aCQyLSbGhlk0DWZXIuUG-NZpc4w4zVZTVNw4VjXW-sbGzt?" WIDTH=468 HEIGHT=60 ALT="GDC Hardcore" BORDER=0></A></td>
    <td align="right" height="60" ><!-- begin main ad tag --><A HREF="http://sally.songline.com:80/@PQL1il1UFnOmn4IwY-wvwWzJwWLv9m2Cr0dsk4dtT3ZhaicrZVhJbmLHXVZuZhjZ42hZamDA9n9XRSjhU2hZO0dsk4dtT3ZhaicQw49hrhZjbn2hP49jb4-fMTIoeSwoXW-sbGDA?"><IMG SRC="http://sally.songline.com:80/@nRbgol1TKFlwpQsQY-avk4Voam2yaWhvbiDSbGhlk0DWZXIupW9Zk4ctphD4bmZw42hZ4XBvQXR320Q5Z2-Z4TLSbGhlk0DWZXIuUG-NZpc4w4zVZTVNw4VjXyECMngWM-DjbGzv?" WIDTH=120 HEIGHT=60 ALT="Find it in Directories!" BORDER=0></A></td>
  </tr>
</table>
<!-- #EndLibraryItem --> <!-- #BeginLibraryItem "/Library/99top_nav.lbi" --><table width="600" border="0" height=60 cellspacing="0" cellpadding="0">
  <tr> 
    <td colspan=3><font face="Verdana, Arial, Helvetica, sans-serif" size="1" color="#990000"><b><i>&nbsp;&nbsp;Miller 
      Freeman Game Group Presents:<map name="gamahome">
        <area shape="rect" coords="4,3,131,54" href="/index.htm" alt="Home">
      </map></i></b></font></td>
  </tr>
  <tr> 
    <td rowspan="2" width="209" height="60"> <img src="/db_area/images/layout/99gamalogo.gif" width="209" height="60" border="0" usemap="#gamahome"></td>
    <td bgcolor="#000000" width="182" height=23>&nbsp;</td>
    <td bgcolor="#000000" align="right" width="209"> <a href="/cgi-bin/join.pl" onMouseOver="MM_preloadImages('/db_area/images/layout/99join_off.gif');MM_swapImage('document.Join','document.Join','/db_area/images/layout/99join_on.gif','#920582065544')" onMouseOut="MM_swapImgRestore()"> 
      <img src="/db_area/images/layout/99join_off.gif" width="40" height="23" border="0" name="Join" alt="Join"></a><img src="/db_area/images/layout/99vert_bar.gif" width="1" height="23"><a href="/help/index.htm" onMouseOver="MM_preloadImages('/db_area/images/layout/99help_off.gif');MM_swapImage('document.Help','document.Help','/db_area/images/layout/99help_on.gif','#920582346659')" onMouseOut="MM_swapImgRestore()"><img src="/db_area/images/layout/99help_off.gif" width="41" height="23" name="Help" border="0" alt="Help"></a><img src="/db_area/images/layout/99vert_bar.gif" width="1" height="23"><a href="/contact_us/index.htm" onMouseOver="MM_preloadImages('/db_area/images/layout/99help_off.gif');MM_swapImage('document.Contact','document.Contact','/db_area/images/layout/99contact_on.gif','#920582404742')" onMouseOut="MM_swapImgRestore()"><img src="/db_area/images/layout/99contact_off.gif" width="78" height="23" name="Contact" border="0" alt="Contact Us"></a><img src="/db_area/images/layout/99vert_bar.gif" width="1" height="23"><a href="/store/index.htm" onMouseOver="MM_preloadImages('/db_area/images/layout/99shop_off.gif');MM_swapImage('document.Shop','document.Shop','/db_area/images/layout/99shop_on.gif','#920583266882')" onMouseOut="MM_swapImgRestore()"><img src="/db_area/images/layout/99shop_off.gif" width="44" height="23" name="Shop" border="0" alt="Shop"></a></td>
  </tr>
  <tr> 
    <td bgcolor="#99CCOO" height=37 colspan=2 align="center"> 
      <table height=37 cellpadding=0 cellspacing=0 border="0" width="90%">
        <form method="post" action="/unisearch/" name="unisearchform">
          <tr valign="bottom"> 
            <td valign="middle"><!-- #BeginLibraryItem "/Library/99top_navsearch.lbi" --><font size="2" face="Arial, Helvetica">
<select name="searchfocus">
  <option value="cgi-bin/AT-editorialsearch.cgi">Editorial</option>
  <option value="cgi-bin/AT-jobsearchsearch.cgi">Job Search</option>
  <option value="connection" selected>---Connection---</option>
  <option value="members">Find a Member</option>
  <option value="events">Events</option>
  <option value="directories">---Directories---</option>
  <option value="companies">Companies</option>
  <option value="products">Products</option>
  <option value="resources">Resources</option>
</select>
<img src="/db_area/images/layout/99arrow.gif" width="15" height="14"> 
<input type="text" name="searchquery" size="12" value="">
</font>
<!-- #EndLibraryItem --></td>
            <td valign="middle"> 
              <input type="image" border="0" name="Search" src="/db_area/images/layout/99search.gif" width="57" height="23" alt="Search">
            </td>
          </tr>
        </form>
      </table>
    </td>
  </tr>
</table>
<!-- #EndLibraryItem --> 
<table width="600" border="0" cellspacing="0" cellpadding="0">
  <tr> 
    <td width="150" valign="top" height="157"> <!-- #BeginLibraryItem "/Library/99side_nav.lbi" --><IMG SRC="/db_area/images/layout/99underlogo.gif" WIDTH="149" HEIGHT="18"><BR>
<A HREF="/newswire/index.htm" ONMOUSEOVER="MM_preloadImages('/db_area/images/layout/99news_off.gif');MM_swapImage('document.NewsWire','document.NewsWire','/db_area/images/layout/99news_on.gif','#920515198692')" ONMOUSEOUT="MM_swapImgRestore()"><IMG SRC="/db_area/images/layout/99news_off.gif" WIDTH="149" HEIGHT="25" NAME="NewsWire" BORDER="0" ALT="Newswire"></A><BR>
<A HREF="/features/index.htm" ONMOUSEOVER="MM_preloadImages('/db_area/images/layout/99features_off.gif');MM_swapImage('document.Features','document.Features','/db_area/images/layout/99features_on.gif','#920516131613')" ONMOUSEOUT="MM_swapImgRestore()"><IMG SRC="/db_area/images/layout/99features_off.gif" WIDTH="149" HEIGHT="27" NAME="Features" BORDER="0" ALT="Features"></A><BR>
<A HREF="/connection/index.htm" ONMOUSEOVER="MM_preloadImages('/db_area/images/layout/99features_off.gif');MM_swapImage('document.Connection','document.Connection','/db_area/images/layout/99connect_on.gif','#920516339983')" ONMOUSEOUT="MM_swapImgRestore()"><IMG SRC="/db_area/images/layout/99connect_off.gif" WIDTH="149" HEIGHT="26" NAME="Connection" BORDER="0" ALT="Connection"></A><BR>
<A HREF="/jobsearch/index.htm" ONMOUSEOVER="MM_preloadImages('/db_area/images/layout/99job_off.gif');MM_swapImage('document.JobSearch','document.JobSearch','/db_area/images/layout/99job_on.gif','#920516860121')" ONMOUSEOUT="MM_swapImgRestore()"><IMG SRC="/db_area/images/layout/99job_off.gif" WIDTH="149" HEIGHT="27" NAME="JobSearch" BORDER="0" ALT="Job Search"></A><BR>
<A HREF="/directories/index.htm" ONMOUSEOVER="MM_preloadImages('/db_area/images/layout/99direct_off.gif');MM_swapImage('document.Directories','document.Directories','/db_area/images/layout/99direct_on.gif','#920516953545')" ONMOUSEOUT="MM_swapImgRestore()"><IMG SRC="/db_area/images/layout/99direct_off.gif" WIDTH="149" HEIGHT="34" NAME="Directories" BORDER="0" ALT="Directories"></A>
<!-- #EndLibraryItem --><br> 
<table width="125" border="0" cellspacing="0" cellpadding="0"> <tr> <td height="12"></td></tr> 
<tr valign="top"> 
          <td><!-- #BeginEditable "sidebar" --> 
            <div align="left"> 
              <p align="left"><font face="Arial, Helvetica, sans-serif" size="-1" color="99000"><b><i>by 
                Jason Bestimt and Bryant Freitag</i></b></font><br>
                <font face=arial,helvetica size=-1><b>Gamasutra</b><br>
                <i>November 15, 1999</i></font></p>
              <table border="0" cellspacing="0" cellpadding="0">
                <tr> 
                  <td width="36"><a href="deformation_printer.htm"><img src="../../db_area/images/layout/99_icon_printer.gif" width="32" height="29" border="0"></a></td>
                  <td><font face="Arial, Helvetica, sans-serif" size="-1"><a href="bestimt_freitag_pfv.htm">Printer 
                    Friendly Version</a></font></td>
                </tr>
              </table>
              <p align="left">&nbsp;</p>
            </div>
            <p><b><img src="../../db_area/images/layout/99_side_features.gif" width="120" height="317"></b></p>
            <!-- #EndEditable --></td>
        </tr> </table></td>
    <td valign="top" WIDTH="450"> 
      <p align="center"><IMG SRC="../../db_area/images/layout/99_head_features.gif" WIDTH="146" HEIGHT="47" ALT="Features"><BR>
        <IMG SRC="../../db_area/images/layout/99_body_divider.gif" WIDTH="445" HEIGHT="5"></p>
      <!-- #BeginEditable "title" --><!-- #EndEditable --> <!-- #BeginEditable "main%20content" --> 
      <div align="left"> 
        <p align="center"><font face="Arial, Helvetica, sans-serif"><b>Real-Time 
          Shadow Casting Using Shadow Volumes</b></font></p>
        <table width="168" border="0" cellspacing="0" cellpadding="6" align="right" vspace="4" hspace="4">
          <tr align="center" bgcolor="#000000"> 
            <td><font size="-1" face="Arial, Helvetica, sans-serif" color="ffffcc"><b>Contents</b></font></td>
          </tr>
          <tr> 
            <td bgcolor="cccc99" height="186"> 
              <p><img src="../../db_area/images/layout/99_icon_arrow.gif" width="6" height="9"> 
                <font face="Arial, Helvetica, sans-serif" size="-1"><b> Real-Time 
                Dynamic Shadow-Casting</b></font></p>
              <p><img src="../../db_area/images/layout/99_icon_arrow.gif" width="6" height="9"> 
                <font face="Arial, Helvetica, sans-serif" size="-1"><b> <a href="bestimt_freitag_02.htm">Implementations 
                / Pros and Cons</a></b></font></p>
              <div align="left"> 
                <p align="left"><img src="../../db_area/images/layout/99_icon_arrow.gif" width="6" height="9"> 
                  <a href="bestimt_freitag_03.htm"><font face="Arial, Helvetica, sans-serif" size="-1"><b>The 
                  Path to Enlightenment</b></font></a></p>
              </div>
            </td>
          </tr>
        </table>
        <p align="left"><font face="Arial, Helvetica, sans-serif">Part of the 
          nerve-tingling pleasure of the immersive gaming experience is entering 
          and exploring elaborately modeled worlds-the more realistic, the better. 
          Games can transport us to an endless variety of locales, from fantastical 
          worlds of magic and mystery to realistic environments of danger and 
          excitement. Improvements in graphics accelerators have let programmers 
          advance beyond the limitations of 2D games and create 3D environments 
          with remarkable realism, while steadily escalating processor speeds 
          and graphics optimization techniques provide new opportunities for refining 
          3D realism and advancing to new levels of interactivity. </font></p>
        <p><font face="Arial, Helvetica, sans-serif">But despite the rich, vibrant 
          colors, the intricately rendered textures, and the dazzling effects 
          exhibited in modern games, the human brain still senses something is 
          missing. The mind perceives that the onscreen image is just a trick, 
          an elaborate ruse played on the intellect by a collaboration of electrons, 
          mathematics, and glowing phosphor. Even with fancy perspective divides 
          and texture perspective correction, the onscreen rendering still lacks 
          a true sense of depth. What's missing? The missing element could be 
          <i>shadows</i>. Without them, the 3D illusion is sorely lacking.</font></p>
        <p><font face="Arial, Helvetica, sans-serif">Real-time dynamic shadowing 
          represents a huge leap forward in realism, depth perception, and the 
          overall presence of objects within a 3D environment. This article discusses 
          one method for generating and rendering shadows using shadow volumes. 
          First, we will explore the concepts involved in representing shadow 
          volumes and explain our particular method for accomplishing this. Then 
          we will examine the pros and cons of this method and consider additional 
          issues that arise when using shadow volumes.</font></p>
        <p><font face="Arial, Helvetica, sans-serif"><b>Let the Shadows Fall Where 
          They May</b></font></p>
        <p><font face="Arial, Helvetica, sans-serif">Many methods currently exist 
          for determining and displaying real-time shadows, including plane projections, 
          texture mapping, shadow volumes, and ray tracing techniques. For an 
          excellent explanation of the texture-mapping method, refer to Hubert 
          Nguyen's article &quot;Casting Shadows on Volumes&quot; in the March 
          1999 issue of <i>Game Developer</i>. Our initial efforts to implement 
          real-time shadowing used a method very similar to the one described 
          by Nguyen. Unfortunately, we found this method hampered by the same 
          negative factors that were recognized and described by Nguyen: slow 
          texture rendering, the large overhead required to self-shadow, the excessive 
          iterations required for complex scenes, and hefty texture dimensions 
          needed to avoid pixelation. Our explorations for a more effective technique 
          led us to shadow casting.</font></p>
        <p><font face="Arial, Helvetica, sans-serif">Rapid improvements in graphics 
          accelerator technology have made it possible to achieve high-end workstation 
          performance in the PC desktop environment. Given these improvements, 
          many graphics techniques can be incorporated into the real-time 3D game 
          space from their original workstation-based roots. Now that 8-bit stencil 
          buffers are appearing on a wide assortment of graphics accelerator cards, 
          shadow-casting methods can be employed for generating real-time shadows 
          with only a minimal performance hit.</font></p>
        <p><font face="Arial, Helvetica, sans-serif">The algorithm includes three 
          important components: a means for generating the 'outside' edge of an 
          object, a method for drawing the shadow volume polygons, and a technique 
          for rendering the actual shadow. We will discuss each of these components 
          conceptually and then provide the actual implementation details in later 
          sections.</font></p>
        <table width="54%" border="0" cellspacing="0" cellpadding="3" align="right">
          <tr bgcolor="#000000"> 
            <td> 
              <div align="center"><img src="shadow_01.gif" width="251" height="212"></div>
            </td>
          </tr>
          <tr bgcolor="#000000"> 
            <td> 
              <div align="center"><font face="Arial, Helvetica, sans-serif" size="-1"><b><font color="#FFFFFF">Figure 
                1. Shadows can be shaped<br>
                and positioned through the use <br>
                of a shadow volume.</font></b></font></div>
            </td>
          </tr>
        </table>
        <p><font face="Arial, Helvetica, sans-serif">The 'outside' edge of an 
          object does not necessarily relate to the convex hull of that object. 
          We need to locate all edges of the object that form the object silhouette 
          from the perspective of the current light source. Once the edges are 
          located, we can create and project the shadow volume. Where the object 
          edges interrupt the cone of light from the light source in the scene, 
          a shadow is cast. Imagine the beam projected from a flashlight, but 
          rather than bathing a scene in light, we use the object to cast a shadow 
          into the scene. Figure 1 sheds some light on this concept (pun intended). 
          Once the silhouette edges are determined, new polygons are formed by 
          the extension of these edges in the direction indicated by the current 
          light source. Collectively, these polygons are referred to as the <i>shadow 
          volume</i>. By correctly combining this volume with stencil buffer operations, 
          shadows can be shaped and positioned within a scene.</font></p>
        <p><font face="Arial, Helvetica, sans-serif">The entire scene is initially 
          rendered without any consideration for shadowing. The trick of the matter 
          is to actually render the shadow volume twice within the scene, invisibly 
          both times. First, the volume is rendered into the scene, incrementing 
          the stencil buffer value for every pixel that passes a normal z depth 
          test. Next, the cull mode for the graphics card is reversed, and the 
          volume is re-rendered. The stencil buffer is decremented for every pixel 
          that again passes a normal z depth test. Figure 2 illustrates this technique. 
          As a result of these operations, the stencil buffer holds a positive 
          value for all pixels that lie within the shadow volume region. This 
          fact logically leads to the next step in the algorithm: the actual rendering 
          of the shadow.</font></p>
        <table width="54%" border="0" cellspacing="0" cellpadding="3" align="center">
          <tr bgcolor="#000000"> 
            <td> 
              <div align="center"><img src="shadow_02.jpg" width="400" height="258"></div>
            </td>
          </tr>
          <tr bgcolor="#000000"> 
            <td height="39"> 
              <div align="center"><font face="Arial, Helvetica, sans-serif" size="-1"><b><font color="#FFFFFF">Figure 
                2. The trick is to render the shadow volume <br>
                twice within the scene, invisibly both times.</font></b></font></div>
            </td>
          </tr>
        </table>
        <p><font face="Arial, Helvetica, sans-serif">After this same series of 
          operations has been performed for all objects in the scene, an alpha-blended 
          quad is rendered to the entire screen. The graphics card is set up to 
          render only the pixels in the stencil buffer that have a positive value 
          associated with them. Shadows now appear in the scene as intended. The 
          stencil buffer should be cleared, and the entire process repeated for 
          the next light in the scene. By correctly configuring the stencil buffer 
          settings during the visible shadow render, the overhead associated with 
          stencil clearing can be minimized. The graphics card can set the stencil 
          buffer value to zero every time the stencil check passes and a shadow 
          pixel is drawn. This operation ensures a zero-filled stencil buffer 
          that is ready for the next light or frame.</font></p>
        <p></p>
        <p align="right"><img src="../../db_area/images/layout/99_icon_arrow.gif" width="6" height="9"><font face="Arial, Helvetica, sans-serif" size="-1"><b><a href="bestimt_freitag_02.htm">Implementations 
          / Pros and Cons</a></b></font></p>
      </div>
      <!-- #EndEditable --> </td>
  </tr> </table><table width="600" border="0" cellpadding="0" cellspacing="0"> 
<tr> <td width="150">&nbsp;</td><td><!-- #BeginLibraryItem "/Library/99_footer.lbi" --> 
<p ALIGN="center"><font face="Arial, Helvetica, sans-serif" size="2"><a href="/"><font color="#800000"><br>
  <br>
  Home</font></a><font color="#800000"> </font>| </font> <FONT FACE="Arial, Helvetica, sans-serif" SIZE="2"> 
  <A HREF="/join/"><FONT COLOR="#800000">Join</FONT></A> | <A HREF="/help/"><FONT COLOR="#800000">Help</FONT></A> 
  | <A HREF="/contact_us/"><FONT COLOR="#800000">Contact Us</FONT></A> | <A HREF="/store/"><FONT COLOR="#800000">Shop</FONT></A> 
  | </FONT><font face="Arial, Helvetica, sans-serif" size="2"><font face="Arial, Helvetica, sans-serif" size="2" color="#800000"><a href="/newswire/">Newswire</a></font><font color="#800000"><br>
  </font><a href="/writers_guidelines/"><font color="#800000">Write for Us</font></a> 
  | <a href="/features/"><font color="#800000">Features</font></a> | <a href="/connection/"><font color="#800000">Connection</font></a> 
  | <a href="/jobsearch/"><font color="#800000">Job Search</font></a> | <a href="/directories/"><font color="#800000">Directories</font></a></font> 
  <BR>

<HR noshade WIDTH="70%" align="center">
<div align="center"><FONT FACE="Arial, Helvetica, sans-serif" SIZE="2"><i>Copyright 
  &copy; 1999-2000 Miller Freeman Inc. All rights reserved.</i></FONT> <BR>
  <BR>
  <IMG SRC="/db_area/images/layout/99game.gif" WIDTH="309" HEIGHT="45" ALT="Miller Freeman Game Group: GDC, GDMag, IGF" border="0" usemap="#mfgamegroup"> 
  <map name="mfgamegroup">
    <area shape="rect" coords="54,0,251,18" href="http://www.mfgame.com/" alt="The Miller Freeman Game Group">
    <area shape="rect" coords="194,20,309,45" href="http://www.indiegames.com/" alt="Independent Games Festival">
    <area shape="rect" coords="119,20,193,45" href="http://www.gdmag.com/" alt="Game Developer Magazine">
    <area shape="rect" coords="1,20,119,45" href="http://www.gdconf.com/" alt="Game Developers Conference">
  </map></div>
<!-- #EndLibraryItem --></td></tr> </table>
</body>
<!-- #EndTemplate --></html>
