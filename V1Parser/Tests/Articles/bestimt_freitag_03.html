<html><!-- #BeginTemplate "/Templates/features - article.dwt" -->
<head>
<!-- #BeginEditable "doctitle" --> 
<title>Gamasutra - Features - &quot;Real-time Shadow Casting Using Shadow Volumes&quot; [11.15.99]</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<SCRIPT language=javascript1.1>
<!--
function OnTopWindow(winwidth,winheight,file_name) {
	TopWindow = window.open(file_name,"Media","toolbar=no,width=" +
winwidth + ",height=" + winheight + ",directories=no,status=yes,scrollbars=no,resize=no,menubar=no")
}
//  -->
</SCRIPT>
<script language="JavaScript">
<!--
function MM_preloadImages() { //v2.0
  if (document.images) {
    var imgFiles = MM_preloadImages.arguments;
    if (document.preloadArray==null) document.preloadArray = new Array();
    var i = document.preloadArray.length;
    with (document) for (var j=0; j<imgFiles.length; j++) if (imgFiles[j].charAt(0)!="#"){
      preloadArray[i] = new Image;
      preloadArray[i++].src = imgFiles[j];
  } }
}

function MM_swapImgRestore() { //v2.0
  if (document.MM_swapImgData != null)
    for (var i=0; i<(document.MM_swapImgData.length-1); i+=2)
      document.MM_swapImgData[i].src = document.MM_swapImgData[i+1];
}

function MM_swapImage() { //v2.0
  var i,j=0,objStr,obj,swapArray=new Array,oldArray=document.MM_swapImgData;
  for (i=0; i < (MM_swapImage.arguments.length-2); i+=3) {
    objStr = MM_swapImage.arguments[(navigator.appName == 'Netscape')?i:i+1];
    if ((objStr.indexOf('document.layers[')==0 && document.layers==null) ||
        (objStr.indexOf('document.all[')   ==0 && document.all   ==null))
      objStr = 'document'+objStr.substring(objStr.lastIndexOf('.'),objStr.length);
    obj = eval(objStr);
    if (obj != null) {
      swapArray[j++] = obj;
      swapArray[j++] = (oldArray==null || oldArray[j-1]!=obj)?obj.src:oldArray[j];
      obj.src = MM_swapImage.arguments[i+2];
  } }
  document.MM_swapImgData = swapArray; //used for restore
}
//-->
</script>
<body bgcolor="#FFFFCC" link="#880000" vlink="#000000" ONLOAD="MM_preloadImages('../../db_area/images/layout/99join_on.gif','#920582065544');MM_preloadImages('../../db_area/images/layout/99help_on.gif','#920582346659');MM_preloadImages('../../db_area/images/layout/99contact_on.gif','#920582404742');MM_preloadImages('../../db_area/images/layout/99shop_on.gif','#920583266882');MM_preloadImages('../../db_area/images/layout/99search_on.gif','#920592177354');MM_preloadImages('../../db_area/images/layout/99news_on.gif','#920515198692');MM_preloadImages('../../db_area/images/layout/99features_on.gif','#920516131613');MM_preloadImages('../../db_area/images/layout/99connect_on.gif','#920516339983');MM_preloadImages('../../db_area/images/layout/99job_on.gif','#920516860121');MM_preloadImages('../../db_area/images/layout/99direct_on.gif','#920516953545')" ALINK="#880000">
<!-- #BeginLibraryItem "/Library/99_ads.lbi" --><table width="599" border="0" cellspacing="0" cellpadding="0" height="68">
  <tr> 
    <td width="468" height="60" align="left"><!-- begin main ad tag --><A HREF="http://sally.songline.com:80/@KLJ0ZS_UOED6WpNgYEFvwWzJwWLv9m2Cr0dsk4dtT3ZhaicrZVhJblRnpya3bGLZ42hZ44DAa4LXMNdiRyBSO0dsk4dtT3ZhaicQw49hrhZjbn2hP49jb4-fw4zs?"><IMG SRC="http://sally.songline.com:80/@GbT39T_lCMQSURbgY-Yvk4Voam2yaWhvbiDSbGhlk0DWZXIupW9Zk450R0s3dWzt42hZ42hvQX-t2yByw8aCQyLSbGhlk0DWZXIuUG-NZpc4w4zVZTVNw4VjXW-sbGzt?" WIDTH=468 HEIGHT=60 ALT="GDC Hardcore" BORDER=0></A></td>
    <td align="right" height="60" ><!-- begin main ad tag --><A HREF="http://sally.songline.com:80/@PQL1il_bt3bBU9zgY-wvwWzJwWLv9m2Cr0dsk4dtT3ZhaicrZVhJbmLHXVZuZhjZ42hZamDA9n9XRSjhU2hZO0dsk4dtT3ZhaicQw49hrhZjbn2hP49jb4-fMTIoeSwoXW-sbGDA?"><IMG SRC="http://sally.songline.com:80/@nRbgol1gdd5hqHPVY-avk4Voam2yaWhvbiDSbGhlk0DWZXIupW9Zk4ctphD4bmZw42hZ4XBvQXR320Q5Z2-Z4TLSbGhlk0DWZXIuUG-NZpc4w4zVZTVNw4VjXyECMngWM-DjbGzv?" WIDTH=120 HEIGHT=60 ALT="Find it in Directories!" BORDER=0></A></td>
  </tr>
</table>
<!-- #EndLibraryItem --> <!-- #BeginLibraryItem "/Library/99top_nav.lbi" --><table width="600" border="0" height=60 cellspacing="0" cellpadding="0">
  <tr> 
    <td colspan=3><font face="Verdana, Arial, Helvetica, sans-serif" size="1" color="#990000"><b><i>&nbsp;&nbsp;Miller 
      Freeman Game Group Presents:<map name="gamahome">
        <area shape="rect" coords="4,3,131,54" href="/index.htm" alt="Home">
      </map></i></b></font></td>
  </tr>
  <tr> 
    <td rowspan="2" width="209" height="60"> <img src="/db_area/images/layout/99gamalogo.gif" width="209" height="60" border="0" usemap="#gamahome"></td>
    <td bgcolor="#000000" width="182" height=23>&nbsp;</td>
    <td bgcolor="#000000" align="right" width="209"> <a href="/cgi-bin/join.pl" onMouseOver="MM_preloadImages('/db_area/images/layout/99join_off.gif');MM_swapImage('document.Join','document.Join','/db_area/images/layout/99join_on.gif','#920582065544')" onMouseOut="MM_swapImgRestore()"> 
      <img src="/db_area/images/layout/99join_off.gif" width="40" height="23" border="0" name="Join" alt="Join"></a><img src="/db_area/images/layout/99vert_bar.gif" width="1" height="23"><a href="/help/index.htm" onMouseOver="MM_preloadImages('/db_area/images/layout/99help_off.gif');MM_swapImage('document.Help','document.Help','/db_area/images/layout/99help_on.gif','#920582346659')" onMouseOut="MM_swapImgRestore()"><img src="/db_area/images/layout/99help_off.gif" width="41" height="23" name="Help" border="0" alt="Help"></a><img src="/db_area/images/layout/99vert_bar.gif" width="1" height="23"><a href="/contact_us/index.htm" onMouseOver="MM_preloadImages('/db_area/images/layout/99help_off.gif');MM_swapImage('document.Contact','document.Contact','/db_area/images/layout/99contact_on.gif','#920582404742')" onMouseOut="MM_swapImgRestore()"><img src="/db_area/images/layout/99contact_off.gif" width="78" height="23" name="Contact" border="0" alt="Contact Us"></a><img src="/db_area/images/layout/99vert_bar.gif" width="1" height="23"><a href="/store/index.htm" onMouseOver="MM_preloadImages('/db_area/images/layout/99shop_off.gif');MM_swapImage('document.Shop','document.Shop','/db_area/images/layout/99shop_on.gif','#920583266882')" onMouseOut="MM_swapImgRestore()"><img src="/db_area/images/layout/99shop_off.gif" width="44" height="23" name="Shop" border="0" alt="Shop"></a></td>
  </tr>
  <tr> 
    <td bgcolor="#99CCOO" height=37 colspan=2 align="center"> 
      <table height=37 cellpadding=0 cellspacing=0 border="0" width="90%">
        <form method="post" action="/unisearch/" name="unisearchform">
          <tr valign="bottom"> 
            <td valign="middle"><!-- #BeginLibraryItem "/Library/99top_navsearch.lbi" --><font size="2" face="Arial, Helvetica">
<select name="searchfocus">
  <option value="cgi-bin/AT-editorialsearch.cgi">Editorial</option>
  <option value="cgi-bin/AT-jobsearchsearch.cgi">Job Search</option>
  <option value="connection" selected>---Connection---</option>
  <option value="members">Find a Member</option>
  <option value="events">Events</option>
  <option value="directories">---Directories---</option>
  <option value="companies">Companies</option>
  <option value="products">Products</option>
  <option value="resources">Resources</option>
</select>
<img src="/db_area/images/layout/99arrow.gif" width="15" height="14"> 
<input type="text" name="searchquery" size="12" value="">
</font>
<!-- #EndLibraryItem --></td>
            <td valign="middle"> 
              <input type="image" border="0" name="Search" src="/db_area/images/layout/99search.gif" width="57" height="23" alt="Search">
            </td>
          </tr>
        </form>
      </table>
    </td>
  </tr>
</table>
<!-- #EndLibraryItem --> 
<table width="600" border="0" cellspacing="0" cellpadding="0">
  <tr> 
    <td width="150" valign="top" height="157"> <!-- #BeginLibraryItem "/Library/99side_nav.lbi" --><IMG SRC="/db_area/images/layout/99underlogo.gif" WIDTH="149" HEIGHT="18"><BR>
<A HREF="/newswire/index.htm" ONMOUSEOVER="MM_preloadImages('/db_area/images/layout/99news_off.gif');MM_swapImage('document.NewsWire','document.NewsWire','/db_area/images/layout/99news_on.gif','#920515198692')" ONMOUSEOUT="MM_swapImgRestore()"><IMG SRC="/db_area/images/layout/99news_off.gif" WIDTH="149" HEIGHT="25" NAME="NewsWire" BORDER="0" ALT="Newswire"></A><BR>
<A HREF="/features/index.htm" ONMOUSEOVER="MM_preloadImages('/db_area/images/layout/99features_off.gif');MM_swapImage('document.Features','document.Features','/db_area/images/layout/99features_on.gif','#920516131613')" ONMOUSEOUT="MM_swapImgRestore()"><IMG SRC="/db_area/images/layout/99features_off.gif" WIDTH="149" HEIGHT="27" NAME="Features" BORDER="0" ALT="Features"></A><BR>
<A HREF="/connection/index.htm" ONMOUSEOVER="MM_preloadImages('/db_area/images/layout/99features_off.gif');MM_swapImage('document.Connection','document.Connection','/db_area/images/layout/99connect_on.gif','#920516339983')" ONMOUSEOUT="MM_swapImgRestore()"><IMG SRC="/db_area/images/layout/99connect_off.gif" WIDTH="149" HEIGHT="26" NAME="Connection" BORDER="0" ALT="Connection"></A><BR>
<A HREF="/jobsearch/index.htm" ONMOUSEOVER="MM_preloadImages('/db_area/images/layout/99job_off.gif');MM_swapImage('document.JobSearch','document.JobSearch','/db_area/images/layout/99job_on.gif','#920516860121')" ONMOUSEOUT="MM_swapImgRestore()"><IMG SRC="/db_area/images/layout/99job_off.gif" WIDTH="149" HEIGHT="27" NAME="JobSearch" BORDER="0" ALT="Job Search"></A><BR>
<A HREF="/directories/index.htm" ONMOUSEOVER="MM_preloadImages('/db_area/images/layout/99direct_off.gif');MM_swapImage('document.Directories','document.Directories','/db_area/images/layout/99direct_on.gif','#920516953545')" ONMOUSEOUT="MM_swapImgRestore()"><IMG SRC="/db_area/images/layout/99direct_off.gif" WIDTH="149" HEIGHT="34" NAME="Directories" BORDER="0" ALT="Directories"></A>
<!-- #EndLibraryItem --><br> 
<table width="125" border="0" cellspacing="0" cellpadding="0"> <tr> <td height="12"></td></tr> 
<tr valign="top"> 
          <td><!-- #BeginEditable "sidebar" --> 
            <div align="left"> 
              <p align="left"><font face="Arial, Helvetica, sans-serif" size="-1" color="99000"><b><i>by 
                Jason Bestimt and Bryant Freitag</i></b></font><br>
                <font face=arial,helvetica size=-1><b>Gamasutra</b><br>
                <i>November 15, 1999</i></font></p>
            </div>
            <p><b><img src="../../db_area/images/layout/99_side_features.gif" width="120" height="317"></b></p>
            <!-- #EndEditable --></td>
        </tr> </table></td>
    <td valign="top" WIDTH="450"> 
      <p align="center"><IMG SRC="../../db_area/images/layout/99_head_features.gif" WIDTH="146" HEIGHT="47" ALT="Features"><BR>
        <IMG SRC="../../db_area/images/layout/99_body_divider.gif" WIDTH="445" HEIGHT="5"></p>
      <!-- #BeginEditable "title" --><!-- #EndEditable --> <!-- #BeginEditable "main%20content" --> 
      <div align="left"> 
        <p align="center"><font face="Arial, Helvetica, sans-serif"><b>Real-Time 
          Shadow Casting Using Shadow Volumes</b></font></p>
        <table width="168" border="0" cellspacing="0" cellpadding="6" align="right" vspace="4" hspace="4">
          <tr align="center" bgcolor="#000000"> 
            <td><font size="-1" face="Arial, Helvetica, sans-serif" color="ffffcc"><b>Contents</b></font></td>
          </tr>
          <tr> 
            <td bgcolor="cccc99" height="186"> 
              <p><img src="../../db_area/images/layout/99_icon_arrow.gif" width="6" height="9"> 
                <font face="Arial, Helvetica, sans-serif" size="-1"><b> <a href="bestimt_freitag_01.htm">Real-Time 
                Dynamic Shadow-Casting</a></b></font></p>
              <p><img src="../../db_area/images/layout/99_icon_arrow.gif" width="6" height="9"> 
                <a href="bestimt_freitag_02.htm"><font face="Arial, Helvetica, sans-serif" size="-1"><b> 
                Implementations / Pros and Cons</b></font></a></p>
              <div align="left"> 
                <p align="left"><img src="../../db_area/images/layout/99_icon_arrow.gif" width="6" height="9"> 
                  <font face="Arial, Helvetica, sans-serif" size="-1"><b>The Path 
                  to Enlightenment</b></font></p>
              </div>
            </td>
          </tr>
        </table>
        <p align="left"><font face="Arial, Helvetica, sans-serif"><b>The Path 
          to Enlightenment</b></font></p>
        <p><font face="Arial, Helvetica, sans-serif">The basic algorithm and the 
          high-level details for successful shadow casting are short and simple. 
          We hope that these have been presented in an enlightening manner. Generally, 
          however, we have only touched on the basic principles of shadow casting. 
          We could easily fill another half-dozen articles with additional perspectives 
          and discussions of related issues. Before concluding this article, we 
          would at least like to touch upon a number of real-world implementation 
          issues that you may want to keep in mind as you approach any project 
          that involves shadow casting. Many of these issues are essential concerns 
          in a real-world shadow casting application.</font></p>
        <p><font face="Arial, Helvetica, sans-serif">Earlier, we introduced the 
          problem of sub-pixel width polygons being produced from high density 
          or small object shadow volumes. Computing and rendering shadow volumes 
          from an invisible level of detail (LOD) model can spare us this problem, 
          as well as minimizing the calculation and rendering time. While this 
          method produces some visual artifacts of its own, primarily objects 
          that shadow themselves, the overall effect is usually acceptable. It 
          is also faster and it reduces the nasty-looking artifacts often associated 
          with sub-pixel rendering. Most overhead involved with LOD shadowing 
          can be amortized if LOD models are being used in the application for 
          other purposes, such as collision detection.</font></p>
        <p><font face="Arial, Helvetica, sans-serif">The most difficult problems 
          encountered with shadow casting involve scene and geometry considerations. 
          You may have noticed that most shadow-casting demos demonstrate the 
          technique using only a single overhead light with a non-moveable camera. 
          This carefully contrived approach helps to build the excitement of the 
          observer (and future implementer) without reckoning with the additional 
          problems of point of view and light source changes. At some point, either 
          during or after the demo, the programmer may latch on to the difficult 
          question, 'What if the camera lies within the shadow volume?' The basis 
          of this shadow casting algorithm relies on the fact that a beam cast 
          from the user's eyeball to any shadowed point in the scene must pass 
          through both the front and back side of the shadow volume. Once the 
          volume swings toward the near plane, this effect is lost. In essence, 
          the user is left staring down the barrel of a corrupt shadow implementation. 
          <br>
          <br>
          Our solution to this problem involved 'capping' the shadow volume whenever 
          this special case was detected. To implement capping, the object geometry 
          was converted to a two-dimensional version and then transformed to the 
          near plane, perfectly capping the open volume. See Figure 4 for a visual 
          example of this technique.</font></p>
        <table width="77%" border="0" cellspacing="0" cellpadding="3" align="center">
          <tr bgcolor="#000000"> 
            <td> 
              <div align="center"><img src="shadow_04.jpg" width="350" height="131"></div>
            </td>
          </tr>
          <tr bgcolor="#000000"> 
            <td height="39"> 
              <div align="center"><font face="Arial, Helvetica, sans-serif" size="-1"><b><font color="#FFFFFF">Figure 
                4. To implement capping, the object geometry was converted to 
                a two-dimensional version and then transformed to the near plane, 
                perfectly capping the open volume</font></b></font></div>
            </td>
          </tr>
        </table>
        <p><font face="Arial, Helvetica, sans-serif">Aggressive frustum culling 
          and high-level scene culling can also cause problems when shadow casting. 
          Even if geometry and lights exist outside the current viewing frustum, 
          the shadow of the geometry can still penetrate into the visible scene. 
          For example, as a shadow volume nears the parallel plane of the ground, 
          it can extend for enormous distances before actually connecting with 
          the ground. This factor must be handled in some manner within in the 
          scene manager, depending on the individual application. Possible solutions 
          include limiting shadow distances (to help the scene manager culling), 
          and performing simple checks to determine if a piece of geometry could 
          possibly shadow the visible scene. Errors in this implementation might 
          cause noticeable 'popping' of shadows as objects are recognized as shadow 
          casters too late in the process.</font></p>
        <p><font face="Arial, Helvetica, sans-serif">The frustum near plane can 
          also cause related problems. Assuming that the application prevents 
          objects from piercing the viewable near plane, a special case still 
          exists in which geometry pierces the non-viewable near plane, yet the 
          light direction causes the shadow volume to cross into view space. This 
          again creates a situation where a given pixel may not lie between both 
          sides of the volume, resulting in undesired effects. Detecting and fixing 
          this case is much more difficult than the 'capping' scenario, because 
          of the intersection with the near plane. One possible solution is to 
          generate a new silhouette to shadow, taking into account the near plane. 
          Another solution is to prevent this case from occurring by handling 
          it at the scene manager level. You may produce popping effects by doing 
          so, but this approach will generally be the simpler of the two. </font></p>
        <p><font face="Arial, Helvetica, sans-serif"><b>Turning Shadows into Special 
          Effects</b></font></p>
        <p><font face="Arial, Helvetica, sans-serif">Rather than just being a 
          source of potential problems, the shadow casting algorithm can also 
          present new effects possibilities. Shadow coloring is one easy addition 
          to the algorithm that can produce highly realistic or amazing creative 
          effects. By altering the color of the overdraw surface from the basic 
          gray presented here in our examples, you can achieve shadow regions 
          with vivid colors or elaborate textures. This effect can be used for 
          accurate shadow colors in multiple colored-light environments, or even 
          strange otherworldly effects, where shadows seem to be swirling, eerie 
          domains of doom and darkness.</font></p>
        <p><font face="Arial, Helvetica, sans-serif">There is no rule that the 
          cast volumes must be used for shadows. By choosing a non-invisible alpha 
          blend mode, and perhaps even textures, you can create interesting spotlight, 
          projector or flare effects from a light source. This technique works 
          well when choosing additive blend modes for the overdraw polygon, creating 
          a realistic light-mapping effect rather than shadows. </font></p>
        <p><font face="Arial, Helvetica, sans-serif"><b>As the Light Source Sets 
          in the West</b></font></p>
        <p><font face="Arial, Helvetica, sans-serif">Throughout this article, 
          we have tried to demystify the process of creating shadows in 3D environments. 
          We have also tried to provide some concrete methods that programmers 
          can employ to add that extra element of realism that real-time shadows 
          can add to an imaginatively rendered world. We hope that the examples 
          and the algorithms will encourage programmers to experiment with these 
          techniques and perhaps adapt them for actual applications. <br>
          <br>
          Improvements in hardware acceleration techniques and software graphics 
          handling techniques will continue to raise the range of possibilities 
          for creative professionals. As processors become blindingly fast, and 
          graphics accelerators process more triangles than a Doritos factory, 
          we can take advantage of all these extra capabilities to produce some 
          extremely interesting applications.</font></p>
        <p></p>
        <p align="right"><img src="../../db_area/images/layout/99_icon_arrow.gif" width="6" height="9"><font face="Arial, Helvetica, sans-serif" size="-1"><b><a href="bestimt_freitag_01.htm">[Back 
          to] Real-Time Dynamic Shadow-Casting</a></b></font></p>
      </div>
      <!-- #EndEditable --> </td>
  </tr> </table><table width="600" border="0" cellpadding="0" cellspacing="0"> 
<tr> <td width="150">&nbsp;</td><td><!-- #BeginLibraryItem "/Library/99_footer.lbi" --> 
<p ALIGN="center"><font face="Arial, Helvetica, sans-serif" size="2"><a href="/"><font color="#800000"><br>
  <br>
  Home</font></a><font color="#800000"> </font>| </font> <FONT FACE="Arial, Helvetica, sans-serif" SIZE="2"> 
  <A HREF="/join/"><FONT COLOR="#800000">Join</FONT></A> | <A HREF="/help/"><FONT COLOR="#800000">Help</FONT></A> 
  | <A HREF="/contact_us/"><FONT COLOR="#800000">Contact Us</FONT></A> | <A HREF="/store/"><FONT COLOR="#800000">Shop</FONT></A> 
  | </FONT><font face="Arial, Helvetica, sans-serif" size="2"><font face="Arial, Helvetica, sans-serif" size="2" color="#800000"><a href="/newswire/">Newswire</a></font><font color="#800000"><br>
  </font><a href="/writers_guidelines/"><font color="#800000">Write for Us</font></a> 
  | <a href="/features/"><font color="#800000">Features</font></a> | <a href="/connection/"><font color="#800000">Connection</font></a> 
  | <a href="/jobsearch/"><font color="#800000">Job Search</font></a> | <a href="/directories/"><font color="#800000">Directories</font></a></font> 
  <BR>

<HR noshade WIDTH="70%" align="center">
<div align="center"><FONT FACE="Arial, Helvetica, sans-serif" SIZE="2"><i>Copyright 
  &copy; 1999-2000 Miller Freeman Inc. All rights reserved.</i></FONT> <BR>
  <BR>
  <IMG SRC="/db_area/images/layout/99game.gif" WIDTH="309" HEIGHT="45" ALT="Miller Freeman Game Group: GDC, GDMag, IGF" border="0" usemap="#mfgamegroup"> 
  <map name="mfgamegroup">
    <area shape="rect" coords="54,0,251,18" href="http://www.mfgame.com/" alt="The Miller Freeman Game Group">
    <area shape="rect" coords="194,20,309,45" href="http://www.indiegames.com/" alt="Independent Games Festival">
    <area shape="rect" coords="119,20,193,45" href="http://www.gdmag.com/" alt="Game Developer Magazine">
    <area shape="rect" coords="1,20,119,45" href="http://www.gdconf.com/" alt="Game Developers Conference">
  </map></div>
<!-- #EndLibraryItem --></td></tr> </table>
</body>
<!-- #EndTemplate --></html>
